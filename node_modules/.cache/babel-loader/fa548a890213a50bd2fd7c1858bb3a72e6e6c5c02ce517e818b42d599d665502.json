{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\n//const URL = \"https://www.googleapis.com/books/v1/volumes?q=query&startIndex=0&maxResults=20\"\nexport const searchbook = createAsyncThunk(\"search/searchbook\", async (_, thunkAPI) => {\n  const {\n    keyword,\n    itemsPerPage\n  } = thunkAPI.getState().searchSlice;\n  const startIndex = 0;\n  const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${keyword}&startIndex=${startIndex}&maxResults=${itemsPerPage}`).then(res => res.json());\n  console.log(\"response\", response, thunkAPI.getState());\n  return response;\n});\nexport const switchPage = createAsyncThunk(\"search/switchPage\", async (newPage, thunkAPI) => {\n  const {\n    keyword,\n    itemsPerPage\n  } = thunkAPI.getState().searchSlice;\n  const startIndex = (newPage - 1) * itemsPerPage;\n  const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${keyword}&startIndex=${startIndex}&maxResults=${itemsPerPage}`).then(res => res.json());\n  return response;\n});\nexport const searchSlice = createSlice({\n  name: \"search\",\n  initialState: {\n    keyword: \"\",\n    isLoading: false,\n    list: [],\n    totalPages: 1,\n    currentPage: 1,\n    itemsPerPage: 10\n  },\n  reducers: {\n    setKeyword: (state, action) => {\n      state.keyword = action.payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(searchbook.pending, (state, action) => {\n      state.isLoading = true;\n    }).addCase(searchbook.fulfilled, (state, action) => {\n      console.log(\"fulfilled\", action.payload);\n      state.isLoading = false;\n      state.totalPages = Math.ceil(action.payload.totalItems / state.itemsPerPage);\n      state.list = action.payload.items;\n    }).addCase(searchbook.rejected, (state, action) => {\n      state.isLoading = false;\n    }).addCase(switchPage.pending, (state, action) => {\n      state.isLoading = true;\n    }).addCase(switchPage.fulfilled, (state, action) => {\n      state.isLoading = false;\n      state.totalPages = Math.ceil(action.payload.totalItems / state.itemsPerPage);\n      state.list = action.payload.items;\n      state.currentPage = action.meta.arg; //newPage\n    }).addCase(switchPage.rejected, (state, action) => {\n      state.isLoading = false;\n    });\n  }\n});\nexport const {\n  setKeyword\n} = searchSlice.actions;\nexport default searchSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","searchbook","_","thunkAPI","keyword","itemsPerPage","getState","searchSlice","startIndex","response","fetch","then","res","json","console","log","switchPage","newPage","name","initialState","isLoading","list","totalPages","currentPage","reducers","setKeyword","state","action","payload","extraReducers","builder","addCase","pending","fulfilled","Math","ceil","totalItems","items","rejected","meta","arg","actions","reducer"],"sources":["C:/Users/LynnC/Downloads/searchbook/searchbook/src/redux/slices/searchSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\n//const URL = \"https://www.googleapis.com/books/v1/volumes?q=query&startIndex=0&maxResults=20\"\nexport const searchbook = createAsyncThunk(\n    \"search/searchbook\",\n    async (_, thunkAPI) => {\n        const { keyword, itemsPerPage } =\n            thunkAPI.getState().searchSlice;\n        const startIndex = 0;\n        const response = await fetch(\n            `https://www.googleapis.com/books/v1/volumes?q=${keyword}&startIndex=${startIndex}&maxResults=${itemsPerPage}`\n        ).then((res) => res.json());\n        console.log(\"response\", response, thunkAPI.getState())\n        return response;\n    }\n);\n\nexport const switchPage = createAsyncThunk(\n    \"search/switchPage\",\n    async (newPage, thunkAPI) => {\n        const { keyword, itemsPerPage } =\n            thunkAPI.getState().searchSlice;\n        const startIndex = (newPage - 1) * itemsPerPage;\n        const response = await fetch(\n            `https://www.googleapis.com/books/v1/volumes?q=${keyword}&startIndex=${startIndex}&maxResults=${itemsPerPage}`\n        ).then((res) => res.json());\n        return response;\n    }\n);\n\nexport const searchSlice = createSlice({\n    name: \"search\",\n    initialState: {\n        keyword: \"\",\n        isLoading: false,\n        list: [],\n        totalPages: 1,\n        currentPage: 1,\n        itemsPerPage: 10,\n    },\n    reducers: {\n        setKeyword: (state, action) => {\n            state.keyword = action.payload;\n        },\n    },\n    extraReducers: (builder) => {\n        builder\n            .addCase(searchbook.pending, (state, action) => {\n                state.isLoading = true;\n            })\n            .addCase(searchbook.fulfilled, (state, action) => {\n                console.log(\"fulfilled\", action.payload)\n                state.isLoading = false;\n                state.totalPages = Math.ceil(action.payload.totalItems / state.itemsPerPage)\n                state.list = action.payload.items;\n            })\n            .addCase(searchbook.rejected, (state, action) => {\n                state.isLoading = false;\n            })\n            .addCase(switchPage.pending, (state, action) => {\n                state.isLoading = true;\n            })\n            .addCase(switchPage.fulfilled, (state, action) => {\n                state.isLoading = false;\n                state.totalPages = Math.ceil(action.payload.totalItems / state.itemsPerPage)\n                state.list = action.payload.items;\n                state.currentPage = action.meta.arg;//newPage\n            })\n            .addCase(switchPage.rejected, (state, action) => {\n                state.isLoading = false;\n            });\n    },\n});\n\nexport const { setKeyword } = searchSlice.actions;\nexport default searchSlice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}